!function(n,t){var a=t.module("taskmanager",["ngResource","ui.sortable","ui.bootstrap","ui.router"]);a.config(["$stateProvider","$httpProvider",function(n,t){n.state("main",{templateUrl:"main.html"}).state("auth",{templateUrl:"auth.html",controller:"authCtrl"}),t.interceptors.push(["$q","$injector",function(n,t){return{responseError:function(a){return 401===a.status&&t.get("$state").go("auth"),n.reject(a)}}}])}]).run(["$state",function(n){n.go("main")}]),n.app=a}(window,window.angular),function(n,t){function a(n,t,a){n.signUp={data:{email:"",password:""},action:function(e){if(!e.$invalid){var o=new t(n.signUp.data);o.$create().then(function(){a.go("main")})["catch"](function(n){console.warn(n)})}}},n.signIn={data:{email:"",password:""},error:"",action:function(e){if(!e.$invalid){var o=new t(n.signIn.data);o.$login().then(function(){a.go("main")})["catch"](function(t){console.warn(t),n.signIn.error=t.data.error})}}}}t.controller("authCtrl",["$scope","userRsc","$state",a])}(window,window.app),function(n,t){function a(n,t){n.$state=t}t.controller("mainCtrl",["$scope","$state",a])}(window,window.app),function(n,t){function a(n,t,a,e){n["delete"]=function(){confirm("Are you sure?")&&n.project.$delete(function(){n.list.splice(n.list.indexOf(n.project),1)})},n.tasks=t.tasks({id:n.project.id}),n.tasks.$promise.then(function(){for(var t in n.tasks)n.tasks[t]=new a(n.tasks[t])}),n.newTask={val:"",save:function(t){if(t.$invalid)return alert("Enter task text");var e=new a({projectId:n.project.id,text:this.val});e.$save().then(function(){n.tasks.push(e),n.newTask.val="",o()})["catch"](function(n){console.warn(n)})}},n.deleteTask=function(t){confirm("Are you sure?")&&t.$delete(function(){n.tasks.splice(n.tasks.indexOf(t),1)})};var o=function(){n.project.tasksOrder=[],n.tasks.forEach(function(t){n.project.tasksOrder.push(t.id)}),n.project.$sort()};n.sortOptions={handle:".move",stop:o},function(){var t;n.editProjectName=function(){t&&e.cancel(t),t=e(function(){n.project.$save()},700)}}(),function(){var t;n.saveTask=function(n,a){return a?(t&&e.cancel(t),void(t=e(function(){n.$save()},700))):n.$save()}}()}t.controller("projectCtrl",["$scope","projects","task","$timeout","$filter",a])}(window,window.app),function(n,t){function a(n,t,a,e){n.list=t.query(),n.createProject=function(){var a=new t({name:"New project"});a.$save().then(function(){n.list.push(a)})["catch"](function(n){console.warn(n)})},n.signOut=function(){a.logout().$promise.then(function(){e.go("auth")})}}t.controller("projectsCtrl",["$scope","projects","userRsc","$state",a])}(window,window.app),function(n,t){t.directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(n,t,a,e){e.$validators.compareTo=function(t){return t==n.otherModelValue},n.$watch("otherModelValue",function(){e.$validate()})}}})}(window,window.app),function(n,t){t.directive("popOverEdit",["$templateCache","$compile",function(t,a){return{restrict:"A",scope:{data:"=popOverEdit",change:"&popOverChange"},link:function(e,o){var r=angular.element(n);o.on("click",function(n){if(n.stopPropagation(),n.target.getAttribute("pop-over-edit")&&!(n.target.children.length>0)){var s=a(t.get("popoveredit.html"))(e),i=function(){s.remove(),r.off("click",i),e.$apply()};r.on("click",i),o.append(s),s.find("input").on("input",e.change),s.find("input")[0].focus(),e.$apply()}})}}}]),t.directive("popOverDatepicker",["$templateCache","$compile","$filter",function(t,a,e){return{restrict:"A",scope:{initialDate:"=popOverDatepicker",change:"&popOverDatepickerChange"},link:function(o,r,s){var i=angular.element(n);o.date=angular.copy(o.initialDate),o.date=new Date(o.date),("Invalid Date"==o.date||0===o.date.valueOf())&&(o.date=null),o.minDate=new Date,r.on("click",function(n){if(n.stopPropagation(),!(null===n.target.getAttribute("pop-over-datepicker")||n.target.children.length>0)){var e=a(t.get("datepicker.html"))(o),s=function(){e.remove(),i.off("click",s),o.$apply()};i.on("click",s),r.append(e),o.$apply()}}),o.$watch("date",function(n,t){n!==t&&(o.initialDate=e("date")(o.date,s.format),o.change())})}}}])}(window,window.app),function(n,t){t.factory("projects",["$resource",function(n){return n("/projects/:listCtrl:id/:docCtrl",{id:"@id",listCtrl:"@listCtrl",docCtrl:"@docCtrl"},{"delete":{method:"DELETE",params:{docCtrl:"delete"}},tasks:{method:"GET",isArray:!0,params:{docCtrl:"tasks"}},sort:{method:"POST",params:{docCtrl:"sort"}}})}])}(window,window.app),function(n,t){t.factory("task",["$resource",function(n){return n("/tasks/:id",{id:"@id"})}])}(window,window.app),function(n,t){t.factory("userRsc",["$resource",function(n){return n("/user/:id/:action",{},{login:{method:"POST",params:{action:"signIn"}},logout:{method:"GET",params:{action:"signOut"}},create:{method:"POST",params:{action:"signUp"}}})}])}(window,window.app),angular.module("taskmanager").run(["$templateCache",function(n){n.put("auth.html",'<tabset class="auth">\n	<tab heading="Sign In">\n		<form novalidate name="signInForm" ng-submit="signIn.action(signInForm)" class="form-horizontal auth-form">\n			<div class="form-group" ng-class="{ \'has-error\' : !signInForm.email.$valid  && (signInForm.email.$dirty || signInForm.$submitted)}">\n				<label for="inputEmail3" class="col-sm-2 control-label">Email</label>\n				<div class="col-sm-10">\n					<input type="email" name="email" required ng-model="signIn.data.email"  class="form-control" id="inputEmail3" placeholder="Email">\n					<span class="error" ng-show="signInForm.email.$error.email">Enter valid email</span>\n				</div>\n			</div>\n			<div class="form-group" ng-class="{ \'has-error\' : !signInForm.password.$valid  && (signInForm.password.$dirty || signInForm.$submitted)}">\n				<label for="inputPassword3" class="col-sm-2 control-label">Password</label>\n				<div class="col-sm-10">\n					<input required  name="password" ng-model="signIn.data.password" type="password" class="form-control" id="inputPassword3" placeholder="Password">\n				</div>\n			</div>\n			<div class="form-group">\n				<div class="col-sm-offset-2 col-sm-10">\n					<button type="submit" class="btn btn-info">Sign In</button>\n					<button type="reset" class="btn btn-warning">Reset</button>\n					<span class="error" ng-if="signIn.error">{{ signIn.error }}</span>\n				</div>\n			</div>\n		</form>\n	</tab>\n\n	<tab heading="Sign Up">\n		<form name="signUpForm" novalidate class="form-horizontal auth-form" ng-submit="signUp.action(signUpForm)">\n			<div class="form-group" ng-class="{ \'has-error\' : !signUpForm.email.$valid  && (signUpForm.email.$dirty || signUpForm.$submitted)}">\n				<label for="inputEmail3" class="col-sm-2 control-label">Email</label>\n				<div class="col-sm-10">\n					<input required ng-model="signUp.data.email" type="email" name="email" class="form-control" id="inputEmail3" placeholder="Email">\n					<span class="error" ng-show="signUpForm.email.$error.email">Enter valid email</span>\n				</div>\n			</div>\n			<div class="form-group" ng-class="{ \'has-error\' : !signUpForm.password.$valid  && (signUpForm.password.$dirty || signUpForm.$submitted)}">\n				<label for="inputPassword3" class="col-sm-2 control-label">Password</label>\n				<div class="col-sm-10">\n					<input ng-minlength="6" ng-maxlength="20" required ng-model="signUp.data.password" type="password" name="password" class="form-control" id="inputPassword3" placeholder="Password">\n					<span class="error" ng-show="signUpForm.password.$error.minlength">Min length is 6</span>\n					<span class="error" ng-show="signUpForm.password.$error.maxlength">Max length is 20</span>\n				</div>\n			</div>\n			<div class="form-group" ng-class="{ \'has-error\' : !signUpForm.confirmPassword.$valid  && (signUpForm.confirmPassword.$dirty || signUpForm.$submitted)}">\n				<label for="inputPassword4" class="col-sm-2 control-label">Confirm password</label>\n				<div class="col-sm-10">\n					<input compare-to="signUp.data.password" ng-model="confirmPassword" required type="password" name="confirmPassword" class="form-control" id="inputPassword4" placeholder="Confirm password">\n\n					<span class="error" ng-show="signUpForm.confirmPassword.$error.compareTo && signUpForm.confirmPassword.$dirty">Passwords doesnt match </span>\n				</div>\n			</div>\n			<div class="form-group">\n				<div class="col-sm-offset-2 col-sm-10">\n					<button type="submit" class="btn btn-info">Sign Up</button>\n					<button type="reset" class="btn btn-warning">Reset</button>\n				</div>\n			</div>\n		</form>\n	</tab>\n</tabset>')}]),angular.module("taskmanager").run(["$templateCache",function(n){n.put("datepicker.html",'<div class="popover right calendar">\n	<div class="arrow"></div>\n\n	<div class="popover-inner">\n		<div name="popoverEditForm" class="popover-content form-inline">\n			<h4>Deadline</h4>\n			<div>\n				<datepicker ng-model="date" min-date="minDate" show-weeks="true" class="well well-sm"></datepicker>\n			</div>\n		</div>\n	</div>\n</div>')}]),angular.module("taskmanager").run(["$templateCache",function(n){n.put("main.html",'<div class="projects" ng-controller="projectsCtrl">\n	<section ng-repeat="project in list" ng-controller="projectCtrl" ng-include="\'project.html\'"></section>\n\n	<div class="create-project">\n		<a href ng-click="createProject()" class="btn btn-primary">Add Project</a>\n		<a href ng-click="signOut()" class="btn btn-default">Log out</a>\n	</div>\n</div>')}]),angular.module("taskmanager").run(["$templateCache",function(n){n.put("popoveredit.html",'<div class="popover top edit-popover">\n	<div class="arrow"></div>\n\n	<div class="popover-inner">\n		<form name="popoverEditForm" class="popover-content form-inline">\n			<div class="form-group" ng-class="{ \'has-error\' :  popoverEditForm.data.$invalid }">\n				<input type="text" ng-model="data" required name="data" class="form-control"/>\n				<div ng-show="popoverEditForm.data.$error.required" class="error text-center">Name is required</div>\n			</div>\n		</form>\n	</div>\n</div>')}]),angular.module("taskmanager").run(["$templateCache",function(n){n.put("project.html",'<div class="head">\n	<div class="title">\n		<span class="text">\n			<span class="glyphicon glyphicon-calendar icon"></span> {{ project.name }}\n		</span>\n\n		<div class="controls">\n			<a href class="edit glyphicon glyphicon-pencil" pop-over-edit="project.name" pop-over-change="editProjectName()"></a>\n			<a href class="remove glyphicon glyphicon-trash" ng-click="delete()"></a>\n		</div>\n	</div>\n</div>\n\n<div class="create-task">\n	<span class="icon glyphicon glyphicon-plus"></span>\n	<form name="newTaskForm" class="input-wrap" ng-submit="newTask.save(newTaskForm)">\n\n		<input required name="newtask" placeholder="Start typing here to create task..." type="text" ng-model="newTask.val" />\n		<button class="add">Add task</button>\n	</form>\n</div>\n\n<ul class="tasks" ui-sortable="sortOptions" ng-model="tasks">\n	<li ng-repeat="task in tasks" class="clearfix">\n		<div class="status">\n			<input type="checkbox" ng-change="saveTask(task)" ng-model="task.complete" ng-true-value="1" ng-false-value="0" />\n		</div>\n		<div class="text" ng-class="{ cross : task.complete }">{{ task.text }}</div>\n		<div class="control text-center">\n			<span class="move glyphicon glyphicon-menu-hamburger"></span>\n			<span class="glyphicon glyphicon-calendar icon" pop-over-datepicker="task.deadline" pop-over-datepicker-change="saveTask(task, true)" format="yyyy-MM-dd"></span>\n			<span class="glyphicon glyphicon-pencil" pop-over-edit="task.text" pop-over-change="saveTask(task, true)"></span>\n			<span class="glyphicon glyphicon-trash" ng-click="deleteTask(task)"></span>\n		</div>\n	</li>\n</ul>')}]);